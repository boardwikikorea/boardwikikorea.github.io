<!DOCTYPE html>
<html lang="ko">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>롱보드 페스티벌</title>

    <!-- SEO 최적화 -->
    <meta name="description" content="보드위키에서 최신 스케이트보드 및 롱보드 정보, 롱보드댄싱과 대회 소식을 만나보세요.">
    <meta name="naver-site-verification" content="e74dc3e49d0527046508b26ee9860c52a501b8f4">

    <!-- Open Graph (OG) -->
    <meta property="og:site_name" content="BoardWiki">
    <meta property="og:title" content="보드 커뮤니티">
    <meta property="og:description" content="최신 보드 소식을 확인하세요.">
    <meta property="og:url" content="https://boardwiki.kr">
    <meta property="og:type" content="website">
    <meta property="og:image" content="https://boardwiki.kr/images/og-image.jpg?ver=20250930">


    <!-- Twitter Card -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="보드위키 - 보드 커뮤니티">
    <meta name="twitter:description" content="최신 보드 소식을 확인하세요.">
    <meta name="twitter:image" content="https://boardwiki.kr/images/twitter-image.jpg">

    <!-- Canonical URL -->
    <link rel="canonical" href="https://boardwiki.kr/">

    <!-- Fonts -->
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=SF+Pro+Display:wght@400;700&display=swap">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/orioncactus/pretendard/dist/web/static/pretendard.css">

    <!-- CSS -->
    <link rel="stylesheet" href="../css/common.css?ver250314">
    <link rel="stylesheet" href="../css/festival.css?ver=250317">

    <!-- JS -->
    <script src="../js/common.js" defer></script>
</head>

<body id="festival">
    <h1 class="sound_only">롱보드 페스티벌</h1>

    <div class="wrap main">
        <article class="content">
            <!-- 전체 조회 버튼 추가 -->
            <button id="fetch-all-reservations">전체 조회</button>

            <div style="overflow-x: auto;">

            <table id="applicationsTable" style="max-width: 1200px;">
                <thead>
                    <tr>
                    <th>이름</th>
                    <th>연락처</th>
                    <th>성별</th>
                    <th>스탠스</th>
                    <th>소속</th>
                    <th>프리스타일</th>
                    <th>히피점프</th>
                    <th>베스트페어</th>
                    <th>레이스</th>
                    <th>신청곡</th>
                    <th>신청일</th>
                    </tr>
                </thead>
                <tbody></tbody>
                </table>
                </table>
            </div>
            
        <script type="module">
            import { initializeApp } from "https://www.gstatic.com/firebasejs/12.4.0/firebase-app.js";
            import { getFirestore, collection, getDocs } from "https://www.gstatic.com/firebasejs/12.4.0/firebase-firestore.js";

            const firebaseConfig = {
            apiKey: "AIzaSyDDkghHYAD581-N3u8zUUsinS1F49P5xi0",
            authDomain: "boardwiki-e070e.firebaseapp.com",
            projectId: "boardwiki-e070e",
            storageBucket: "boardwiki-e070e.appspot.com",
            messagingSenderId: "301441212066",
            appId: "1:301441212066:web:1ffff5d8eccaaff11781fb",
            measurementId: "G-DZ52LV9MMG"
            };

            const app = initializeApp(firebaseConfig);
            const db = getFirestore(app);

            async function fetchAllApplications() {
            const querySnapshot = await getDocs(collection(db, "festivalApplications"));
            const tableBody = document.querySelector("#applicationsTable tbody");
            tableBody.innerHTML = "";

            querySnapshot.forEach((doc) => {
                const data = doc.data();

                const freestyleLabel = {
                amateur: "일반부",
                open: "오픈부",
                master: "마스터부",
                none: "없음"
                }[data.freestyle] || "없음";

                const createdAt = data.createdAt?.toDate
                ? data.createdAt.toDate().toLocaleString("ko-KR")
                : "-";

                const row = document.createElement("tr");
                row.innerHTML = `
                <td>${data.name || "-"}</td>
                <td>${data.contact || "-"}</td>
                <td>${data.gender === "male" ? "남" : "여"}</td>
                <td>${data.stance}</td>
                <td>${data.team || "-"}</td>
                <td>${freestyleLabel}</td>
                <td>${data.hippyJump ? "✅" : "❌"}</td>
                <td>${data.bestPair ? "✅" : "❌"}</td>
                <td>${data.race ? "✅" : "❌"}</td>
                <td>${data.song || "-"}</td>
                <td>${createdAt}</td>
                `;
                tableBody.appendChild(row);
            });
            }

            window.onload = () => {
            const btn = document.getElementById("fetch-all-reservations");
            btn.addEventListener("click", () => {
                const password = prompt("관리자 암호를 입력하세요:");
                if (password === "202511") {
                fetchAllApplications();
                } else {
                alert("잘못된 암호입니다.");
                }
            });
            };
        </script>


        </article>

        <footer>
            서비스 제공 <a href="../index.html">@boardwiki</a>
        </footer>
    </div>

</body>

</html>
