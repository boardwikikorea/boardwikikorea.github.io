<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ë¡±ë³´ë“œ ëŒ€ì¶•ì œ</title>

    <!-- SEO ìµœì í™” -->
    <meta name="description" content="ë³´ë“œìœ„í‚¤ì—ì„œ ìµœì‹  ìŠ¤ì¼€ì´íŠ¸, ë¡±ë³´ë“œ ì •ë³´ì™€ ë¡±ë³´ë“œëŒ„ì‹±, ë³´ë“œëŒ€íšŒ ì†Œì‹ì„ í™•ì¸í•˜ì„¸ìš”.">
    <meta name="keywords" content="ìŠ¤ì¼€ì´íŠ¸, ë¡±ë³´ë“œ, ì¹´ë²„ë³´ë“œ, ë¡±ë³´ë“œëŒ„ì‹±, ë³´ë“œëŒ€íšŒ, longboarding, ë¡±ë³´ë“œ ëŒ€ì¶•ì œ, ë¡±ë³´ë“œ í˜ìŠ¤í‹°ë²Œ, longboard festival">
    <meta name="naver-site-verification" content="e74dc3e49d0527046508b26ee9860c52a501b8f4">

    <!-- Open Graph (OG) -->
    <meta property="og:site_name" content="BoardWiki">
    <meta property="og:title" content="ë¡±ë³´ë“œ ëŒ€ì¶•ì œ">
    <meta property="og:description" content="ìŠ¤ì¼€ì´íŠ¸Â·ë¡±ë³´ë“œ ìµœì‹  ì •ë³´ë¥¼ í™•ì¸í•˜ì„¸ìš”.">
    <meta property="og:url" content="https://boardwiki.kr">
    <meta property="og:type" content="website">
    <meta property="og:image" content="https://boardwiki.kr/images/og-image.jpg?ver=20250930">

    <!-- Twitter Card -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="ë³´ë“œìœ„í‚¤ - ìŠ¤ì¼€ì´íŠ¸Â·ë¡±ë³´ë“œ ì»¤ë®¤ë‹ˆí‹°">
    <meta name="twitter:description" content="ë³´ë“œìœ„í‚¤ì—ì„œ ìµœì‹  ìŠ¤ì¼€ì´íŠ¸, ë¡±ë³´ë“œ ì •ë³´ë¥¼ ë§Œë‚˜ë³´ì„¸ìš”.">
    <meta name="twitter:image" content="https://boardwiki.kr/images/twitter-image.jpg">

    <!-- Canonical URL -->
    <link rel="canonical" href="https://boardwiki.kr/">

    <!-- Fonts -->
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=SF+Pro+Display:wght@400;700&display=swap">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/orioncactus/pretendard/dist/web/static/pretendard.css">

    <!-- CSS -->
    <link rel="stylesheet" href="../css/common.css?ver250314">
    <link rel="stylesheet" href="../css/festival.css?ver=250317">

    <!-- JS -->
    <script src="../js/common.js" defer></script>

<script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/12.4.0/firebase-app.js";
  import { getFirestore, collection, getDocs } from "https://www.gstatic.com/firebasejs/12.4.0/firebase-firestore.js";

  const firebaseConfig = {
    apiKey: "AIzaSyDDkghHYAD581-N3u8zUUsinS1F49P5xi0",
    authDomain: "boardwiki-e070e.firebaseapp.com",
    projectId: "boardwiki-e070e",
    storageBucket: "boardwiki-e070e.appspot.com",
    messagingSenderId: "301441212066",
    appId: "1:301441212066:web:1ffff5d8eccaaff11781fb",
    measurementId: "G-DZ52LV9MMG"
  };

  const app = initializeApp(firebaseConfig);
  const db = getFirestore(app);

  async function fetchAllApplications() {
    const querySnapshot = await getDocs(collection(db, "festivalApplications"));
    const allData = [];

    querySnapshot.forEach((doc) => {
      const data = doc.data();
      allData.push({ id: doc.id, ...data });
    });

    // 1ï¸âƒ£ createdAt ê¸°ì¤€ìœ¼ë¡œ ìµœì‹ ìˆœ ì •ë ¬
    allData.sort((a, b) => {
      const timeA = a.createdAt?.toDate ? a.createdAt.toDate().getTime() : 0;
      const timeB = b.createdAt?.toDate ? b.createdAt.toDate().getTime() : 0;
      return timeB - timeA;
    });

    // 2ï¸âƒ£ ì´ë¦„ ê¸°ì¤€ìœ¼ë¡œ ì¤‘ë³µ ì œê±°
    const uniqueData = [];
    const seenNames = new Set();

    for (const entry of allData) {
      const name = entry.name?.trim();
      if (name && !seenNames.has(name)) {
        uniqueData.push(entry);
        seenNames.add(name);
      }
    }

    // 3ï¸âƒ£ ì¹´í…Œê³ ë¦¬ë³„ ë¶„ë¥˜
    const categories = {
      "í”„ë¦¬ìŠ¤íƒ€ì¼ (Freestyle) No Sponsor_(ë‚¨, Male)": [],
      "í”„ë¦¬ìŠ¤íƒ€ì¼ (Freestyle) No Sponsor_(ì—¬, Female)": [],
      "í”„ë¦¬ìŠ¤íƒ€ì¼ (Freestyle) ì˜¤í”ˆ (Open)_(ë‚¨, Male)": [],
      "í”„ë¦¬ìŠ¤íƒ€ì¼ (Freestyle) ì˜¤í”ˆ (Open)_(ì—¬, Female)": [],
      "í”„ë¦¬ìŠ¤íƒ€ì¼ (Freestyle) ë§ˆìŠ¤í„° (Master)": [],
      "í˜ì–´ Pair": [],
      "íˆí”¼ì í”„ Hippy Jump": [],
      "ë ˆì´ìŠ¤ Race": []
    };

    uniqueData.forEach((d) => {
      const gender = d.gender === "male" ? "ë‚¨, Male" : "ì—¬, Female";

      if (d.freestyle === "none") return;

      if (d.freestyle === "amateur") categories[`í”„ë¦¬ìŠ¤íƒ€ì¼ (Freestyle) No Sponsor_(${gender})`]?.push(d.name);
      if (d.freestyle === "open") categories[`í”„ë¦¬ìŠ¤íƒ€ì¼ (Freestyle) ì˜¤í”ˆ (Open)_(${gender})`]?.push(d.name);
      if (d.freestyle === "master") categories["í”„ë¦¬ìŠ¤íƒ€ì¼ (Freestyle) ë§ˆìŠ¤í„° (Master)"]?.push(d.name);

      if (d.bestPair) categories["í˜ì–´ Pair"].push(d.name);
      if (d.hippyJump) categories["íˆí”¼ì í”„ Hippy Jump"].push(d.name);
      if (d.race) categories["ë ˆì´ìŠ¤ Race"].push(d.name);
    });

    // 4ï¸âƒ£ í™”ë©´ ë Œë”ë§
    const container = document.querySelector(".category-list");
    container.innerHTML = "";

    for (const [category, names] of Object.entries(categories)) {
      const section = document.createElement("section");
      section.innerHTML = `
        <h3 style="margin-top: 1.5rem;">${category} - ${names.length}ëª…</h3>
        <ul style="padding-left: 1rem;">
          ${names.map(name => `<li>${name}</li>`).join("")}
        </ul>
      `;
      container.appendChild(section);
    }
  }

  // ğŸ”’ ê´€ë¦¬ì ë¹„ë°€ë²ˆí˜¸ë¡œ ì ‘ê·¼ ì œì–´
  window.onload = () => {
    fetchAllApplications();
  };
</script>


  <style>
    .category-list { margin-bottom: 3rem; }
    .category-list h3 {
      font-size: 1.5rem;
      margin-bottom: 1rem;
      border-bottom: 2px solid #ccc;
      padding-bottom: 0.5rem;
    }

    .category-list ul {
      width: 100%;
      border-collapse: collapse;
      margin-bottom: 1rem;
      border-top:1px solid #ddd;
    }

    .category-list li{
      border: 1px solid #ddd;
      border-top:0;
      padding: 0.75rem;
      text-align: center;
    }


    .category-list li:nth-child(even){
      background-color: #fafafa;
    }

    button#fetch-all-reservations {
      background-color: #333;
      color: white;
      padding: 0.75rem 1.5rem;
      border: none;
      border-radius: 6px;
      cursor: pointer;
      font-weight: bold;
    }

    button#fetch-all-reservations:hover {
      background-color: #555;
    }
  </style>
</head>

<body id="festival">
  <h1 class="sound_only">ë¡±ë³´ë“œ ëŒ€ì¶•ì œ</h1>

    <div class="language-switcher">
        <button type="button" class="active" id="btn-kr">KR</button>
        <button type="button" id="btn-en">EN</button>
    </div>

    
  <div class="wrap main">


  
    <article class="content">

      <div class="form-header">
        <h2>ì°¸ê°€ì ëª©ë¡ (Participant List)</h2>
        <a href="./index.html" class="close-btn">âœ–</a>
      </div>
      
      <div class="category-list" style="margin-top: 2rem;">

      </div>

    </article>
    <footer>ì„œë¹„ìŠ¤ ì œê³µ <a href="../index.html">@boardwiki</a></footer>
  </div>
</body>
</html>
